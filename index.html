<index.html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Duck & Star Shooter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html, body { margin:0; height:100%; background:#060914; color:#e8f2ff; font-family:system-ui, Arial, sans-serif; overflow:hidden; }
    #hud {
      position: fixed; top: 10px; left: 10px; z-index: 2; padding:10px 12px; border-radius:10px;
      background: rgba(10,14,32,0.55); border:1px solid rgba(255,255,255,0.08); backdrop-filter: blur(4px);
      font-size: 13px; line-height: 1.35; user-select: none; display:none;
    }
    #hud .title { font-weight:700; letter-spacing:0.4px; margin-bottom:4px; }
    #overlay {
      position: fixed; inset: 0; display:grid; place-items:center; text-align:center;
      z-index:3; background: rgba(0,0,0,0.65); color:#e8f2ff; font-weight:700; gap:16px;
    }
    #overlay .tip { font-weight:500; opacity:0.9; }
    #startBtn {
      font-size: 20px; padding: 14px 26px; border-radius: 8px; border:none;
      background:#48bfff; color:#03202d; cursor:pointer; font-weight:700;
    }
    canvas { display:block; width:100vw; height:100vh; }
    .key { padding:1px 6px; border-radius:6px; border:1px solid rgba(255,255,255,0.2); background:rgba(255,255,255,0.08); }
  </style>
</head>
<body>
  <div id="hud">
    <div class="title">Duck & Star Shooter</div>
    Move <span class="key">←</span><span class="key">→</span> or A/D • Shoot <span class="key">Space</span>/<span class="key">↑</span> • Mouse aim + Click
    <div style="margin-top:4px">Pause <span class="key">P</span> • Restart <span class="key">R</span></div>
    <div id="stats" style="margin-top:6px;">Score: 0 • Lives: 3 • Level: 1</div>
  </div>

  <div id="overlay">
    <div>Duck & Star Shooter</div>
    <button id="startBtn">▶ Start Game</button>
    <div class="tip">After Start, a duck will appear within 1 second. Try clicking to shoot!</div>
  </div>

  <canvas id="game" aria-label="Duck and star shooter"></canvas>

  <script>
  (function() {
    // DOM
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const hud = document.getElementById('hud');
    const overlay = document.getElementById('overlay');
    const startBtn = document.getElementById('startBtn');
    const statsEl = document.getElementById('stats');

    // Canvas / DPI
    let W = 0, H = 0, DPR = 1;
    function resize() {
      DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      W = Math.floor(window.innerWidth);
      H = Math.floor(window.innerHeight);
      canvas.width = Math.floor(W * DPR);
      canvas.height = Math.floor(H * DPR);
      canvas.style.width = W + 'px';
      canvas.style.height = H + 'px';
      ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
      initBackground();
      player.y = H - 60;
      if (player.x === 0) player.x = W / 2;
      player.x = clamp(player.x, 30, W - 30);
    }
    window.addEventListener('resize', resize, { passive: true });

    // Helpers
    const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
    const rr = (a, b) => a + Math.random() * (b - a);
    const chance = p => Math.random() < p;

    // State
    const world = {
      running: false,
      score: 0,
      lives: 3,
      time: 0,
      level: 1,
      duckTimer: 0,
      starTimer: 0
    };
    const keys = new Set();
    const mouse = { x: 0, y: 0, down: false };
    const player = { x: 0, y: 0, w: 46, h: 24, speed: 420, recoil: 0 };

    const bullets = [];
    const ducks = [];
    const stars = [];
    const bgStars = [];

    function initBackground() {
      bgStars.length = 0;
      const n = Math.min(220, Math.floor(W * H / 14000));
      for (let i = 0; i < n; i++) {
        bgStars.push({ x: Math.random() * W, y: Math.random() * H, r: rr(0.4, 1.6), t: Math.random() * Math.PI * 2, s: rr(0.05, 0.3) });
      }
    }

    // Input
    document.addEventListener('keydown', (e) => {
      const c = e.code || e.key;
      if (['ArrowLeft','ArrowRight','ArrowUp','Space','KeyA','KeyD','KeyW','KeyP','KeyR'].includes(c)) e.preventDefault();
      if (c === 'KeyP') { togglePause(); return; }
      if (c === 'KeyR') { reset(true); return; }
      keys.add(c);
    }, { passive: false });
    document.addEventListener('keyup', (e) => keys.delete(e.code || e.key), { passive: true });

    canvas.addEventListener('mousemove', (e) => {
      const r = canvas.getBoundingClientRect();
      mouse.x = e.clientX - r.left;
      mouse.y = e.clientY - r.top;
    }, { passive: true });
    canvas.addEventListener('mousedown', () => { mouse.down = true; shootMouse(); });
    canvas.addEventListener('mouseup', () => { mouse.down = false; });

    // Start button wiring — guarantees action immediately
    startBtn.addEventListener('click', () => {
      overlay.style.display = 'none';
      hud.style.display = 'block';
      reset(true);
      // Force immediate spawns so you see life right away
      spawnDuck();
      spawnStar();
    });

    // Shooting
    let lastKeyShot = 0, lastMouseShot = 0;
    function shootKeyboard() {
      const now = performance.now();
      if (now - lastKeyShot < 160) return;
      lastKeyShot = now;
      bullets.push({ x: player.x, y: player.y - player.h / 2, vx: 0, vy: -820, r: 3, color: '#8fd1ff' });
      player.recoil = 5;
    }
    function shootMouse() {
      const now = performance.now();
      if (now - lastMouseShot < 130) return;
      lastMouseShot = now;
      const dx = mouse.x - player.x;
      const dy = mouse.y - (player.y - player.h / 2);
      const L = Math.hypot(dx, dy) || 1;
      const sp = 880;
      bullets.push({ x: player.x, y: player.y - player.h / 2, vx: (dx / L) * sp, vy: (dy / L) * sp, r: 3, color: '#ffd18f' });
      player.recoil = 5;
    }

    // Spawners
    function spawnDuck() {
      const y = rr(80, H * 0.6);
      const L2R = chance(0.5);
      const spd = rr(90, 180) + world.level * 8;
      ducks.push({ x: L2R ? -50 : W + 50, y, vx: L2R ? spd : -spd, vy: rr(-14, 14), r: rr(16, 22), t: rr(0, Math.PI * 2) });
    }
    function spawnStar() {
      stars.push({ x: rr(30, W - 30), y: -20, vy: rr(60, 120), r: rr(8, 12), spin: rr(0, Math.PI * 2) });
    }

    // Update and draw
    function update(dt) {
      world.time += dt;
      world.level = 1 + Math.floor(world.time / 30);

      // Player movement
      const left = keys.has('ArrowLeft') || keys.has('KeyA');
      const right = keys.has('ArrowRight') || keys.has('KeyD');
      if (left) player.x -= player.speed * dt;
      if (right) player.x += player.speed * dt;
      player.x = clamp(player.x, 30, W - 30);
      player.y = H - 60;
      if (player.recoil > 0) player.recoil -= 0.6;

      // Shooting
      const shootKey = keys.has('ArrowUp') || keys.has('KeyW') || keys.has('Space');
      if (shootKey) shootKeyboard();
      if (mouse.down) shootMouse();

      // Spawn timers
      world.duckTimer -= dt;
      world.starTimer -= dt;
      const duckIv = Math.max(0.4, 1.2 - world.level * 0.08);
      if (world.duckTimer <= 0) { world.duckTimer = duckIv; spawnDuck(); }
      if (world.starTimer <= 0) { world.starTimer = rr(2.0, 3.2); spawnStar(); }

      // BG star twinkle
      for (const s of bgStars) s.t += s.s * 0.05;

      // Bullets
      for (let i = bullets.length - 1; i >= 0; i--) {
        const b = bullets[i];
        b.x += b.vx * dt; b.y += b.vy * dt;
        if (b.x < -30 || b.x > W + 30 || b.y < -30 || b.y > H + 30) bullets.splice(i, 1);
      }

      // Ducks
      for (let i = ducks.length - 1; i >= 0; i--) {
        const d = ducks[i];
        d.x += d.vx * dt; d.y += d.vy * dt; d.t += dt * 2; d.vy += Math.sin(d.t) * 4 * dt;
        if (d.x < -80 || d.x > W + 80) ducks.splice(i, 1);
      }

      // Stars (targets)
      for (let i = stars.length - 1; i >= 0; i--) {
        const s = stars[i];
        s.y += s.vy * dt; s.spin += 1.6 * dt;
        if (s.y > H + 30) stars.splice(i, 1);
      }

      // Collisions: bullets with ducks and stars
      for (let i = bullets.length - 1; i >= 0; i--) {
        const b = bullets[i];
        let hit = false;

        // Ducks
        for (let j = ducks.length - 1; j >= 0; j--) {
          const d = ducks[j];
          const dx = b.x - d.x, dy = b.y - d.y;
          if (dx*dx + dy*dy <= (b.r + d.r * 0.9) ** 2) {
            ducks.splice(j, 1); world.score += 5; hit = true; break;
          }
        }
        if (hit) { bullets.splice(i, 1); continue; }

        // Stars
        for (let k = stars.length - 1; k >= 0; k--) {
          const s = stars[k];
          const dx = b.x - s.x, dy = b.y - s.y;
          if (dx*dx + dy*dy <= (b.r + s.r) ** 2) {
            stars.splice(k, 1); world.score += 8; hit = true; break;
          }
        }
        if (hit) bullets.splice(i, 1);
      }

      // Ducks that reach ground damage player
      for (let i = ducks.length - 1; i >= 0; i--) {
        const d = ducks[i];
        if (d.y > H - 100) { ducks.splice(i, 1); damage(); }
      }

      statsEl.textContent = `Score: ${world.score} • Lives: ${world.lives} • Level: ${world.level}`;
    }

    function draw() {
      // Sky gradient
      const g = ctx.createLinearGradient(0, 0, 0, H);
      g.addColorStop(0, '#07102b'); g.addColorStop(0.6, '#0b1740'); g.addColor
      Update index.html with full game code
